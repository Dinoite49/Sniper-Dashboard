<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SignalSync Pro â€¢ Institutional Suite</title>
    
    <!-- TradingView & Charting Libraries -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        :root { 
            --bg: #030712; 
            --card: rgba(17, 24, 39, 0.8); 
            --accent: #00ff88; 
            --red: #ff4b2b; 
            --text: #f9fafb; 
            --gold: #f5b041; 
            --blue: #2d7ee9;
            --gray: #1f2937;
            --border: rgba(255, 255, 255, 0.08);
            --glass: blur(16px);
            --bbg: #0a0c15; /* bloomberg dark */
            --panel: rgba(0, 0, 0, 0.6);
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bbg); color: var(--text); height: 100vh; overflow: hidden; display: flex; }

        /* ===== SIDEBAR PROFISSIONAL ===== */
        .sidebar { 
            width: 80px; background: rgba(0, 0, 0, 0.6); backdrop-filter: var(--glass);
            border-right: 1px solid var(--border); display: flex; flex-direction: column; 
            align-items: center; padding: 28px 0; gap: 12px; z-index: 100;
        }
        .nav-item {
            width: 52px; height: 52px; border-radius: 18px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; gap: 4px;
            cursor: pointer; transition: all 0.3s; background: rgba(255, 255, 255, 0.02); 
            color: #6b7280; font-size: 11px; font-weight: 600; border: 1px solid transparent;
        }
        .nav-item i { font-size: 20px; }
        .nav-item.active { background: rgba(0, 255, 136, 0.1); border-color: var(--accent); color: var(--accent); box-shadow: 0 0 20px rgba(0, 255, 136, 0.15); }
        .nav-item:not(.active):hover { background: rgba(255,255,255,0.05); color: #d1d5db; }

        /* ===== APP CONTAINER ===== */
        .app-container { flex: 1; display: flex; flex-direction: column; background: radial-gradient(circle at 20% 30%, #101624, #030712); overflow: hidden; }

        .top-bar { 
            height: 64px; padding: 0 24px; display: flex; align-items: center; justify-content: space-between;
            border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.3); backdrop-filter: blur(10px);
        }
        .logo-area h1 { font-size: 20px; font-weight: 800; letter-spacing: -1px; line-height: 1.2; }
        .logo-area span { color: var(--accent); font-weight: 800; }
        .pair-badge { background: var(--gray); padding: 4px 12px; border-radius: 30px; font-size: 12px; font-weight: 600; border: 1px solid var(--border); margin-left: 16px; }

        .clock-area { text-align: right; font-family: 'JetBrains Mono'; }
        .clock-area .time { font-size: 15px; font-weight: 600; color: var(--accent); }
        .clock-area .date { font-size: 10px; color: #9ca3af; }

        /* ===== MAIN STAGE (PAGES) ===== */
        .main-stage { flex: 1; padding: 20px; overflow-y: auto; display: none; height: 100%; }
        .main-stage.active-page { display: block; }

        /* grid systems */
        .grid-2 { display: grid; grid-template-columns: 1.6fr 1fr; gap: 20px; height: 100%; }
        .grid-2-rev { display: grid; grid-template-columns: 1fr 1.6fr; gap: 20px; height: 100%; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .panel-card { background: var(--card); backdrop-filter: var(--glass); border-radius: 24px; border: 1px solid var(--border); padding: 20px; box-shadow: 0 10px 30px -15px black; }
        .panel-title { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #9ca3af; margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center; }
        .panel-title span { color: var(--accent); font-weight: 800; }

        /* Chart containers */
        .chart-container { width: 100%; height: calc(100% - 40px); border-radius: 16px; overflow: hidden; background: #000; }
        #tv-chart { width: 100%; height: 100%; }

        /* CVD & Volume specific */
        .cvd-bar { display: flex; align-items: center; gap: 8px; margin: 4px 0; }
        .cvd-volume { height: 6px; border-radius: 3px; background: var(--accent); }
        .cvd-negative { background: var(--red); }

        .depth-visual { display: flex; height: 120px; align-items: flex-end; gap: 2px; margin-top: 20px; }
        .depth-bar { flex: 1; background: var(--blue); border-radius: 4px 4px 0 0; }

        /* order flow tape */
        .tape-item { font-family: 'JetBrains Mono'; font-size: 11px; display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,0.05); padding: 6px 0; }
        .tape-bid { color: var(--red); }
        .tape-ask { color: var(--accent); }

        /* intel panel (reusable) */
        .intel-badge { padding: 4px 8px; border-radius: 8px; background: rgba(0,255,136,0.1); color: var(--accent); font-size: 10px; font-weight: 800; }
        
        /* terminal */
        .terminal-output { font-family: 'JetBrains Mono'; font-size: 12px; color: #d1d5db; height: 200px; overflow-y: auto; background: #0a0c15; padding: 12px; border-radius: 12px; line-height: 1.6; }

        /* buttons */
        .btn-primary { background: linear-gradient(135deg, #00ff88, #00a3ff); border: none; color: black; font-weight: 800; padding: 14px 24px; border-radius: 40px; cursor: pointer; transition: 0.2s; text-transform: uppercase; letter-spacing: 1px; font-size: 12px; }
        .btn-primary:hover { filter: brightness(1.1); transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,255,136,0.3); }

        @media (max-width: 1100px) { .grid-2, .grid-2-rev, .grid-3 { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <!-- SIDEBAR NAVIGATION - PÃ¡ginas institucionais -->
    <nav class="sidebar">
        <div class="nav-item active" data-page="dashboard" title="Dashboard"><i class="fas fa-chart-pie"></i><span>Home</span></div>
        <div class="nav-item" data-page="chart" title="Chart Pro"><i class="fas fa-chart-line"></i><span>Chart</span></div>
        <div class="nav-item" data-page="cvd" title="CVD & Volume"><i class="fas fa-chart-bar"></i><span>CVD</span></div>
        <div class="nav-item" data-page="volume" title="Volume Profile"><i class="fas fa-layer-group"></i><span>Profile</span></div>
        <div class="nav-item" data-page="terminal" title="Terminal"><i class="fas fa-terminal"></i><span>Terminal</span></div>
        <div class="nav-item" data-page="mentor" title="Mentor IA"><i class="fas fa-robot"></i><span>Mentor</span></div>
        <div class="nav-item" style="margin-top:auto;" onclick="location.reload()" title="Reiniciar"><i class="fas fa-sync-alt"></i><span>Reset</span></div>
    </nav>

    <div class="app-container">
        <header class="top-bar">
            <div style="display: flex; align-items: center;">
                <div class="logo-area">
                    <h1>SignalSync <span>PRO</span></h1>
                </div>
                <div class="pair-badge" id="global-pair">FX:EURUSD</div>
            </div>
            <div class="clock-area">
                <div class="time" id="live-clock">22:15:30</div>
                <div class="date" id="live-date">2025-02-21</div>
            </div>
        </header>

        <!-- PÃGINA DASHBOARD (Home) -->
        <main id="page-dashboard" class="main-stage active-page">
            <div class="grid-2">
                <div class="panel-card" style="padding: 0; overflow: hidden;">
                    <div style="padding: 16px 20px 0 20px;" class="panel-title">Live Heatmap <span>Â· 15 ativos</span></div>
                    <div id="tv-mini-chart" style="height: 250px; width:100%;"></div>
                    <div style="padding: 20px; display: flex; gap: 10px;">
                        <div><span class="intel-badge">OI +2.3%</span> BTC</div>
                        <div><span class="intel-badge" style="color:var(--red);">OI -0.7%</span> ETH</div>
                    </div>
                </div>
                <div class="grid-2" style="grid-template-columns: 1fr; gap:20px;">
                    <div class="panel-card">
                        <div class="panel-title">CVD acumulado (15min) <span>#Delta</span></div>
                        <div id="cvd-micro-chart" style="height: 120px;"></div>
                        <div style="display: flex; justify-content: space-between; margin-top: 16px;">
                            <div><span style="color: #9ca3af;">Compra</span> 1.4k</div>
                            <div><span style="color: #9ca3af;">Venda</span> 1.1k</div>
                            <div><span style="color:var(--accent);">Delta +276</span></div>
                        </div>
                    </div>
                    <div class="panel-card">
                        <div class="panel-title">Mentor Flash</div>
                        <div id="dashboard-mentor" style="font-size: 13px;">ðŸ“ˆ Smart money acumulando no 0.618. Clique no botÃ£o para anÃ¡lise completa.</div>
                        <button class="btn-primary" style="margin-top: 16px; width:100%;" onclick="runSignalSync()">Sincronizar AnÃ¡lise</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- PÃGINA CHART PROFISSIONAL -->
        <main id="page-chart" class="main-stage">
            <div class="grid-2-rev">
                <div class="panel-card" style="padding: 0; overflow: hidden;">
                    <div id="tv-chart" style="height: 100%; width:100%;"></div>
                </div>
                <div class="panel-card" style="display: flex; flex-direction: column; gap:16px;">
                    <div class="panel-title">Ferramentas de Desenho <span>Pro</span></div>
                    <div style="display: flex; gap:8px; flex-wrap:wrap;">
                        <span class="intel-badge">Fibonacci</span>
                        <span class="intel-badge">Canal</span>
                        <span class="intel-badge">Perfil Volume</span>
                        <span class="intel-badge">Order Block</span>
                    </div>
                    <div style="border-top: 1px solid var(--border); margin: 10px 0;"></div>
                    <div class="panel-title">PosiÃ§Ãµes Institucionais</div>
                    <div class="tape-item"><span>JPMorgan</span><span class="tape-ask">+320 lots</span></div>
                    <div class="tape-item"><span>Goldman</span><span class="tape-bid">-150 lots</span></div>
                    <div class="tape-item"><span>MM Algo</span><span class="tape-ask">+890 lots</span></div>
                </div>
            </div>
        </main>

        <!-- PÃGINA CVD (Cumulative Volume Delta) -->
        <main id="page-cvd" class="main-stage">
            <div class="grid-2">
                <div class="panel-card">
                    <div class="panel-title">Cumulative Volume Delta <span>1h Â· Real-time</span></div>
                    <div id="cvd-main-chart" style="height: 300px;"></div>
                    <div style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap:12px;">
                        <div><span class="intel-badge">Compra total</span> 8.432</div>
                        <div><span class="intel-badge">Venda total</span> 7.215</div>
                        <div><span class="intel-badge">Delta acum.</span> +1.217</div>
                        <div><span class="intel-badge">CVD tendÃªncia</span> Alta</div>
                    </div>
                </div>
                <div class="panel-card">
                    <div class="panel-title">Order Flow Tape <span>#Bid/Ask</span></div>
                    <div style="height: 350px; overflow-y: scroll;">
                        <div class="tape-item"><span>1.1025</span><span class="tape-bid">12 ðŸ”»</span><span class="tape-ask">8 ðŸ”º</span></div>
                        <div class="tape-item"><span>1.1024</span><span class="tape-bid">5 ðŸ”»</span><span class="tape-ask">23 ðŸ”º</span></div>
                        <div class="tape-item"><span>1.1023</span><span class="tape-bid">1 ðŸ”»</span><span class="tape-ask">17 ðŸ”º</span></div>
                        <!-- mais itens simulados -->
                    </div>
                </div>
            </div>
        </main>

        <!-- PÃGINA VOLUME PROFILE -->
        <main id="page-volume" class="main-stage">
            <div class="grid-2-rev">
                <div class="panel-card">
                    <div class="panel-title">Volume Profile (HVN/LVN) <span>24h</span></div>
                    <div id="volume-profile-chart" style="height: 350px;"></div>
                </div>
                <div class="panel-card">
                    <div class="panel-title">Depth of Market <span>NÃ­vel 2</span></div>
                    <div class="depth-visual">
                        <div class="depth-bar" style="height: 80px;"></div><div class="depth-bar" style="height: 120px;"></div><div class="depth-bar" style="height: 60px;"></div>
                        <div class="depth-bar" style="height: 140px;"></div><div class="depth-bar" style="height: 90px;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin: 12px 0;"><span>Bid size: 2.4M</span><span>Ask size: 1.9M</span></div>
                    <div class="panel-title" style="margin-top:20px;">Cluster Volume</div>
                    <div>Zona de alto volume: 1.1015 - 1.1030</div>
                </div>
            </div>
        </main>

        <!-- PÃGINA TERMINAL (Bloomberg-style) -->
        <main id="page-terminal" class="main-stage">
            <div class="grid-3">
                <div class="panel-card">
                    <div class="panel-title">NotÃ­cias <span>Reuters</span></div>
                    <div class="terminal-output" id="news-terminal">ðŸ“° Carregando...</div>
                </div>
                <div class="panel-card">
                    <div class="panel-title">Fluxo de Ordens</div>
                    <div class="terminal-output">14:32:23  BTC  +234 @ 62k<br>14:31:10  ETH  -56 @ 3k<br>14:29:45  EUR  +1.2k lots</div>
                </div>
                <div class="panel-card">
                    <div class="panel-title">PosiÃ§Ãµes Abertas</div>
                    <div class="tape-item"><span>GBP/USD</span><span>+2.3M</span><span class="tape-ask">compra</span></div>
                    <div class="tape-item"><span>XAU/USD</span><span>-1.1M</span><span class="tape-bid">venda</span></div>
                </div>
            </div>
        </main>

        <!-- PÃGINA MENTOR IA (detalhado) -->
        <main id="page-mentor" class="main-stage">
            <div class="grid-2">
                <div class="panel-card">
                    <div class="panel-title">MENTOR <span>SignalSync IA</span></div>
                    <div id="mentor-full" class="terminal-output" style="height: 200px;">AnÃ¡lise aguardando sincronizaÃ§Ã£o...</div>
                    <button class="btn-primary" style="margin-top:20px;" onclick="runSignalSync()">Executar varredura Gemini</button>
                </div>
                <div class="panel-card">
                    <div class="panel-title">Cognito Bias <span>mercado</span></div>
                    <div id="cognito-full" style="font-size: 14px;">FOMO institucional em BTC, medo em EUR.</div>
                    <div class="aura-bar-container" style="margin:20px 0;"><div id="aura-large" class="aura-fill" style="width:70%;"></div></div>
                    <div>Sentimento: <span id="aura-text">Greed 70%</span></div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // GLOBAIS
        let currentPair = 'FX:EURUSD';
        let tvWidget = null;
        let charts = {};

        // NavegaÃ§Ã£o entre pÃ¡ginas
        document.querySelectorAll('.nav-item[data-page]').forEach(item => {
            item.addEventListener('click', (e) => {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                const pageId = item.dataset.page;
                document.querySelectorAll('.main-stage').forEach(p => p.classList.remove('active-page'));
                document.getElementById(`page-${pageId}`).classList.add('active-page');

                // se for chart page, inicializa TradingView se nÃ£o existir
                if (pageId === 'chart' && !tvWidget) {
                    initChart();
                }
                if (pageId === 'dashboard') {
                    initMiniChart();
                }
                if (pageId === 'cvd') initCVDchart();
                if (pageId === 'volume') initVolumeProfile();
            });
        });

        // RelÃ³gio
        function updateClock() {
            const now = new Date();
            document.getElementById('live-clock').innerText = now.toLocaleTimeString('pt-BR', { hour12: false });
            document.getElementById('live-date').innerText = now.toISOString().split('T')[0];
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Atualiza par global
        function setGlobalPair(pair) {
            currentPair = pair;
            document.getElementById('global-pair').innerText = pair;
        }

        // Inicializa grÃ¡fico TradingView (pÃ¡gina chart)
        function initChart() {
            if (tvWidget) { tvWidget.remove(); }
            tvWidget = new TradingView.widget({
                "autosize": true,
                "symbol": currentPair,
                "interval": "15",
                "theme": "dark",
                "style": "1",
                "locale": "br",
                "container_id": "tv-chart",
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "details": true,
                "studies": ["VolumeProfile@tv-basicstudies", "CumulativeVolumeDelta@tv-basicstudies"]
            });
        }

        // mini chart dashboard (lightweight)
        function initMiniChart() {
            const container = document.getElementById('tv-mini-chart');
            if (!container) return;
            container.innerHTML = '<canvas style="width:100%; height:100%; background:#0f121c;"></canvas>';
            // lightweight chart fake
            try {
                const chart = LightweightCharts.createChart(container, { width: container.clientWidth, height: 250, layout: { backgroundColor: '#000', textColor: '#d1d5db' } });
                const series = chart.addCandlestickSeries();
                series.setData(generateMockCandles(30));
            } catch (e) {}
        }

        function initCVDchart() {
            const container = document.getElementById('cvd-main-chart');
            if (!container) return;
            container.innerHTML = '';
            const chart = LightweightCharts.createChart(container, { height: 300, layout: { backgroundColor: '#0a0c15', textColor: 'white' } });
            const cvdSeries = chart.addHistogramSeries({ color: '#00ff88', priceFormat: { type: 'volume' } });
            const data = [];
            for (let i = 0; i < 50; i++) {
                data.push({ time: '2025-02-2' + (i%9+1), value: Math.random() * 200 - 50, color: Math.random() > 0.5 ? '#00ff88' : '#ff4b2b' });
            }
            cvdSeries.setData(data);
        }

        function initVolumeProfile() {
            const container = document.getElementById('volume-profile-chart');
            if (!container) return;
            container.innerHTML = '<div style="color:#9ca3af; text-align:center;">Perfil de Volume (simulaÃ§Ã£o) <br> HVN em 1.1020, LVN em 1.1040</div>';
        }

        // mock candlestick data
        function generateMockCandles(n) {
            let data = [];
            let time = new Date('2025-02-01').getTime() / 1000;
            for (let i = 0; i < n; i++) {
                data.push({ time: time + i*3600, open: 1.1, high: 1.105, low: 1.095, close: 1.102 });
            }
            return data;
        }

        // troca de par (chamado pelos atalhos da sidebar original, mas podemos integrar)
        window.changePair = function(pair) {
            setGlobalPair(pair);
            if (tvWidget) {
                tvWidget.setSymbol(pair, '15');
            }
        };

        // adaptar os antigos botoes da sidebar de pares? podemos inserir novos elementos
        // vamos injetar na sidebar os pares tambem? mas ja temos navegacao, mas adicionar shortcuts
        const pairNav = document.createElement('div');
        pairNav.style.marginTop = '20px';
        pairNav.style.borderTop = '1px solid var(--border)';
        pairNav.style.paddingTop = '12px';
        pairNav.style.display = 'flex';
        pairNav.style.flexDirection = 'column';
        pairNav.style.gap = '8px';
        pairNav.innerHTML = `
            <div class="nav-item small" style="width:52px; height:40px;" onclick="changePair('FX:EURUSD')">EU</div>
            <div class="nav-item small" style="width:52px; height:40px;" onclick="changePair('FX:GBPUSD')">GU</div>
            <div class="nav-item small" style="width:52px; height:40px;" onclick="changePair('OANDA:XAUUSD')">AU</div>
            <div class="nav-item small" style="width:52px; height:40px;" onclick="changePair('BINANCE:BTCUSDT')">â‚¿</div>
        `;
        document.querySelector('.sidebar').appendChild(pairNav);

        // FunÃ§Ã£o SignalSync (IA) aprimorada, usando fetch para Gemini ou mock
        window.runSignalSync = async function() {
            const mentorEl = document.getElementById('mentor-full') || document.getElementById('dashboard-mentor');
            const auraFill = document.getElementById('aura-large') || document.getElementById('aura-fill');
            const auraText = document.getElementById('aura-text');
            const cognitoEl = document.getElementById('cognito-full');

            if (mentorEl) mentorEl.innerHTML = "â³ Conectando Ã  rede neural Gemini 1.5 Flash...";

            // SimulaÃ§Ã£o institucional com dados fake (substituir por chamada real futuramente)
            setTimeout(() => {
                if (mentorEl) mentorEl.innerHTML = "ðŸ“Š **AnÃ¡lise Smart Money**\nCVD positivo em EURUSD, volume acumulado em 1.1020. Grandes players comprando na regiÃ£o do 0.618. O fluxo de ordens indica exaustÃ£o de vendedores. Zona de interesse: 1.0990-1.1025. TendÃªncia de curto prazo: ALTISTA.";
                if (auraFill) auraFill.style.width = '78%';
                if (auraText) auraText.innerText = 'Euforia moderada 78%';
                if (cognitoEl) cognitoEl.innerText = 'ViÃ©s de confirmaÃ§Ã£o: institucionais acumulando posiÃ§Ã£o comprada. FOMO ainda nÃ£o iniciado.';
                if (document.getElementById('aura-label')) document.getElementById('aura-label').innerText = 'Greed';
                if (document.getElementById('cognito-desc')) document.getElementById('cognito-desc').innerText = 'Dominante: ViÃ©s de confirmaÃ§Ã£o';
                if (document.getElementById('mentor-txt')) document.getElementById('mentor-txt').innerHTML = '<strong>Smart money:</strong> Oferta sendo absorvida.';
            }, 1500);
        };

        // Inicializa com a pÃ¡gina dashboard
        window.onload = function() {
            initMiniChart();
            // Inicia noticias no terminal
            const newsDiv = document.getElementById('news-terminal');
            if (newsDiv) {
                fetch(`https://newsapi.org/v2/everything?q=forex&pageSize=5&apiKey=821b7bb1311c454f9b0c92369865838c`)
                .then(r => r.json())
                .then(d => {
                    if (d.articles) newsDiv.innerHTML = d.articles.map(a => `ðŸ“Œ ${a.title}`).join('<br>');
                }).catch(() => newsDiv.innerHTML = 'NotÃ­cias indisponÃ­veis (modo offline)');
            }
        };

        // Mock das funÃ§Ãµes antigas para nÃ£o quebrar
        window. changePairOld = function(p) { changePair(p); };
    </script>

    <!-- estilo extra para os botoes pequenos de par -->
    <style>
        .nav-item.small { font-size: 12px; font-weight: 800; height: 36px; border-radius: 12px; }
        .aura-fill { background: linear-gradient(90deg, var(--red), var(--gold), var(--accent)); height: 100%; border-radius: 4px; }
        .aura-bar-container { background: #1f2937; height: 8px; border-radius: 4px; overflow: hidden; }
    </style>
</body>
</html>